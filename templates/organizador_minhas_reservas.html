{% extends "base.html" %}
{% block title %}Minhas Reservas{% endblock %}

{% block content %}

<h2 class="section-title mb-2">Minhas Reservas</h2>
<p class="section-subtitle mb-5">
    Eventos que vocÃª organizou
</p>

{% if eventos|length == 0 %}
    <p class="text-muted">
        VocÃª ainda nÃ£o possui reservas.
    </p>
{% endif %}

<div class="data-list">

    {% for evento in eventos %}
    <div class="data-row" style="align-items: flex-start; gap: 32px;">

        <!-- INFORMAÃ‡Ã•ES -->
        <div style="flex: 1;">
            <div class="data-title mb-1">
                {{ evento.nome }}
            </div>

            <div class="data-meta mb-1">
                ğŸ“ {{ evento.local }}
            </div>

            <div class="data-meta mb-2">
                ğŸ—“ {{ evento.data_hora }}
            </div>

            <div class="data-meta mb-3">
                ğŸ‘¥ Inscritos: <strong>{{ evento.inscritos }}</strong> /
                Reservados: {{ evento.num_pessoas }}
            </div>

            <!-- LINK INSCRIÃ‡ÃƒO -->
            <div style="max-width: 520px;">
                <small class="font-weight-bold d-block mb-1">
                    Link para inscriÃ§Ã£o
                </small>

                <div class="d-flex">
                    <input type="text"
                           class="form-control form-control-sm"
                           value="{{ evento.link_inscricao }}"
                           readonly>

                    <button class="btn btn-sm btn-outline-secondary ml-2"
                            onclick="navigator.clipboard.writeText('{{ evento.link_inscricao }}')">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>

                <small class="text-muted">
                    Compartilhe este link
                </small>
            </div>
        </div>

        <!-- AÃ‡Ã•ES -->
        <div class="d-flex flex-column align-items-end" style="gap: 10px;">

            <a href="{{ url_for('lista_participantes', evento_id=evento.id) }}"
               class="btn btn-primary btn-sm">
                Detalhes / QR Code
            </a>

            {% if evento.pode_excluir %}
            <form method="POST"
                  action="{{ url_for('excluir_reserva', evento_id=evento.id) }}"
                  onsubmit="return confirm(
                    'Tem certeza que deseja cancelar a reserva {{ evento.nome }}?'
                  );">
                <button type="submit"
                        class="btn btn-sm btn-outline-danger">
                    Cancelar
                </button>
            </form>
            {% else %}
                <button class="btn btn-sm btn-secondary" disabled>
                    Reserva ConcluÃ­da
                </button>
            {% endif %}

        </div>

    </div>
    {% endfor %}

</div>

<div class="mt-5">
    <a href="{{ url_for('organizador_salas') }}" class="secondary-link">
        + Reservar novas salas
    </a>
</div>

{% endblock %}
